<!-- DeviceManagerWindow.xaml - 簡化後的工具列 -->
<Window x:Class="SentryX.DeviceManagerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="設備管理 - Device Manager" 
        Height="500" Width="800"
        MinHeight="400" MinWidth="600"
        WindowStartupLocation="CenterScreen">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- 工具列 -->
            <RowDefinition Height="*"/>
            <!-- 設備清單 -->
            <RowDefinition Height="Auto"/>
            <!-- 設備詳情 -->
            <RowDefinition Height="100"/>
            <!-- 狀態區 -->
        </Grid.RowDefinitions>

        <!-- ✅ 簡化後的工具列 -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Background="LightGray" Margin="5">
            <Button Name="AddDeviceButton" Content="➕ 添加設備" Click="AddDeviceButton_Click"
                    ToolTip="清空輸入欄位，準備添加新設備"/>
            <Button Name="EditDeviceButton" Content="✏️ 編輯設備" Click="EditDeviceButton_Click"
                    ToolTip="編輯選中的設備資訊"/>
            <Button Name="RemoveDeviceButton" Content="🗑️ 移除設備" Click="RemoveDeviceButton_Click"
                    ToolTip="移除選中的設備"/>
            <Separator Width="20"/>
            <Button Name="LogoutDeviceButton" Content="📤 登出設備" Click="LogoutDeviceButton_Click"
                    ToolTip="登出選中的設備"/>

            <!-- 顯示自動刷新狀態 -->
            <Separator Width="20"/>
            <TextBlock Text="🔄 自動刷新" VerticalAlignment="Center" 
                       Foreground="Green" FontWeight="Bold"/>
        </StackPanel>

        <!-- 設備清單 -->
        <DataGrid Grid.Row="1" Name="DeviceDataGrid" 
                  AutoGenerateColumns="False"
                  SelectionMode="Single"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  Margin="5"
                  SelectionChanged="DeviceDataGrid_SelectionChanged">
            <DataGrid.Columns>
                <DataGridTextColumn Header="設備名稱" Binding="{Binding Name}" Width="150" IsReadOnly="True"/>
                <DataGridTextColumn Header="IP 地址" Binding="{Binding IpAddress}" Width="120" IsReadOnly="True"/>
                <DataGridTextColumn Header="埠號" Binding="{Binding Port}" Width="60" IsReadOnly="True"/>
                <DataGridTextColumn Header="帳號" Binding="{Binding Username}" Width="80" IsReadOnly="True"/>
                <DataGridTextColumn Header="序號" Binding="{Binding SerialNumber}" Width="150" IsReadOnly="True"/>
                <DataGridTextColumn Header="通道數" Binding="{Binding ChannelCount}" Width="60" IsReadOnly="True"/>
                <DataGridTextColumn Header="狀態" Binding="{Binding StatusDisplay}" Width="80" IsReadOnly="True"/>
                <DataGridTextColumn Header="最後連接" Binding="{Binding LastConnectTime, StringFormat='{}{0:MM-dd HH:mm}'}" Width="100" IsReadOnly="True"/>
            </DataGrid.Columns>
        </DataGrid>

        <!-- 設備詳情編輯區 -->
        <GroupBox Grid.Row="2" Header="設備詳情" Margin="5">
            <StackPanel Orientation="Vertical">
                <!-- 第一行 -->
                <StackPanel Orientation="Horizontal" Margin="5">
                    <TextBlock Text="設備名稱:" Width="80" VerticalAlignment="Center"/>
                    <TextBox Name="DeviceNameTextBox" Width="150" Margin="5,0"/>

                    <TextBlock Text="IP 地址:" Width="60" VerticalAlignment="Center" Margin="20,0,0,0"/>
                    <TextBox Name="DeviceIPTextBox" Width="120" Margin="5,0"/>

                    <TextBlock Text="埠號:" Width="40" VerticalAlignment="Center" Margin="20,0,0,0"/>
                    <TextBox Name="DevicePortTextBox" Text="37777" Width="60" Margin="5,0"/>
                </StackPanel>

                <!-- 第二行 -->
                <StackPanel Orientation="Horizontal" Margin="5">
                    <TextBlock Text="帳號:" Width="80" VerticalAlignment="Center"/>
                    <TextBox Name="UsernameTextBox" Text="admin" Width="150" Margin="5,0"/>

                    <TextBlock Text="密碼:" Width="60" VerticalAlignment="Center" Margin="20,0,0,0"/>
                    <PasswordBox Name="PasswordBox" Password="123456" Width="120" Margin="5,0"/>

                    <!-- ✅ 改成儲存並連接 -->
                    <Button Name="SaveDeviceButton" Content="💾 儲存並連接" 
                            Click="SaveDeviceButton_Click" Margin="30,0,0,0" Padding="15,5"
                            Background="LightGreen" FontWeight="Bold"
                            ToolTip="儲存設備資訊並立即嘗試連接"/>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <!-- 狀態區 -->
        <GroupBox Grid.Row="3" Header="操作狀態" Margin="5">
            <ScrollViewer>
                <TextBlock Name="StatusTextBlock" 
                          Text="設備管理器已就緒，具備自動刷新功能..."
                          TextWrapping="Wrap"
                          Margin="5"/>
            </ScrollViewer>
        </GroupBox>
    </Grid>
</Window>