<Window x:Class="SentryX.PlaybackControlDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="回放控制" Height="500" Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize">
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 當前狀態顯示 -->
        <GroupBox Grid.Row="0" Header="當前狀態" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock x:Name="CurrentStatusText" Text="請選擇要回放的分割區域" FontWeight="Bold" Foreground="Blue"/>
                <TextBlock x:Name="DeviceInfoText" Text="設備資訊將在此顯示" Margin="0,5,0,0"/>
            </StackPanel>
        </GroupBox>

        <!-- 日期選擇 -->
        <GroupBox Grid.Row="1" Header="選擇日期" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal">
                <Label Content="日期：" VerticalAlignment="Center"/>
                <DatePicker x:Name="PlaybackDatePicker" Margin="5" 
                           SelectedDateChanged="PlaybackDatePicker_SelectedDateChanged"/>
                <Button Content="今天" Click="SetToday_Click" Margin="10,0,0,0" Padding="10,5"/>
                <Button Content="昨天" Click="SetYesterday_Click" Margin="10,0,0,0" Padding="10,5"/>
            </StackPanel>
        </GroupBox>

        <!-- 24小時時間軸 -->
        <GroupBox Grid.Row="2" Header="24小時時間軸" Margin="0,0,0,10">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="40"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- 時間刻度標籤 -->
                <Canvas Grid.Row="0" Height="20">
                    <!-- 動態生成的時間刻度標籤將在程式碼中添加 -->
                </Canvas>

                <!-- 時間軸滑動條 -->
                <Canvas Grid.Row="1" Name="TimelineCanvas" Background="LightGray" 
                        MouseLeftButtonDown="TimelineCanvas_MouseLeftButtonDown"
                        MouseMove="TimelineCanvas_MouseMove"
                        MouseLeftButtonUp="TimelineCanvas_MouseLeftButtonUp">

                    <!-- 錄影區段顯示 -->
                    <!-- 動態生成的錄影區段將在程式碼中添加 -->

                    <!-- 開始時間指針 -->
                    <Rectangle x:Name="StartTimeMarker" 
                               Width="3" Height="40" 
                               Fill="Green" 
                               Canvas.Left="0" Canvas.Top="0"
                               ToolTip="開始時間"/>

                    <!-- 結束時間指針 -->
                    <Rectangle x:Name="EndTimeMarker" 
                               Width="3" Height="40" 
                               Fill="Red" 
                               Canvas.Left="200" Canvas.Top="0"
                               ToolTip="結束時間"/>

                    <!-- 當前播放位置指針 -->
                    <Rectangle x:Name="CurrentPositionMarker" 
                               Width="2" Height="40" 
                               Fill="Blue" 
                               Canvas.Left="100" Canvas.Top="0"
                               ToolTip="當前播放位置"
                               Visibility="Collapsed"/>
                </Canvas>

                <!-- 時間顯示和控制 -->
                <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,5,0,0">
                    <TextBlock Text="開始: " FontWeight="Bold"/>
                    <TextBlock x:Name="StartTimeText" Text="00:00:00" Foreground="Green" MinWidth="60"/>
                    <TextBlock Text="  結束: " FontWeight="Bold" Margin="20,0,0,0"/>
                    <TextBlock x:Name="EndTimeText" Text="01:00:00" Foreground="Red" MinWidth="60"/>
                    <TextBlock Text="  持續時間: " FontWeight="Bold" Margin="20,0,0,0"/>
                    <TextBlock x:Name="DurationText" Text="01:00:00" Foreground="Blue" MinWidth="60"/>
                </StackPanel>
            </Grid>
        </GroupBox>

        <!-- 快速時間選擇按鈕 -->
        <GroupBox Grid.Row="3" Header="快速選擇" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal">
                <Button Content="過去30分鐘" Click="SetQuickTime_Click" Tag="30m" Margin="0,0,10,0" Padding="8,3"/>
                <Button Content="過去1小時" Click="SetQuickTime_Click" Tag="1h" Margin="0,0,10,0" Padding="8,3"/>
                <Button Content="過去2小時" Click="SetQuickTime_Click" Tag="2h" Margin="0,0,10,0" Padding="8,3"/>
                <Button Content="過去4小時" Click="SetQuickTime_Click" Tag="4h" Margin="0,0,10,0" Padding="8,3"/>
                <Button Content="早上(06-12)" Click="SetQuickTime_Click" Tag="morning" Margin="0,0,10,0" Padding="8,3"/>
                <Button Content="下午(12-18)" Click="SetQuickTime_Click" Tag="afternoon" Margin="0,0,10,0" Padding="8,3"/>
                <Button Content="晚上(18-24)" Click="SetQuickTime_Click" Tag="evening" Margin="0,0,10,0" Padding="8,3"/>
                <Button Content="全天" Click="SetQuickTime_Click" Tag="fullday" Margin="0,0,10,0" Padding="8,3"/>
            </StackPanel>
        </GroupBox>

        <!-- 回放控制按鈕 -->
        <GroupBox Grid.Row="4" Header="回放控制" Margin="0,0,0,10">
            <StackPanel Orientation="Horizontal">
                <Button x:Name="StartPlaybackButton" Content="▶ 開始回放" Click="StartPlayback_Click" 
                        Margin="0,0,10,0" Padding="10,5" IsEnabled="False"/>
                <Button x:Name="StopPlaybackButton" Content="⏹ 回到實況" Click="StopPlayback_Click" 
                        Margin="0,0,10,0" Padding="10,5" IsEnabled="False"/>

                <!-- 分隔線 -->
                <Rectangle Width="2" Height="25" Fill="Gray" Margin="10,0"/>

                <!-- 回放控制按鈕 -->
                <Button x:Name="PauseButton" Content="⏸ 暫停" Click="PlaybackControl_Click" Tag="Pause"
                        Margin="5,0" Padding="8,5" IsEnabled="False"/>
                <Button x:Name="RewindButton" Content="⏮ 倒帶" Click="PlaybackControl_Click" Tag="Rewind"
                        Margin="5,0" Padding="8,5" IsEnabled="False"/>
                <Button x:Name="SlowButton" Content="⏪ 慢放" Click="PlaybackControl_Click" Tag="Slow"
                        Margin="5,0" Padding="8,5" IsEnabled="False"/>
                <Button x:Name="NormalButton" Content="▶ 正常" Click="PlaybackControl_Click" Tag="Normal"
                        Margin="5,0" Padding="8,5" IsEnabled="False"/>
                <Button x:Name="FastButton" Content="⏩ 快進" Click="PlaybackControl_Click" Tag="Fast"
                        Margin="5,0" Padding="8,5" IsEnabled="False"/>
            </StackPanel>
        </GroupBox>

        <!-- 回放狀態顯示 -->
        <GroupBox Grid.Row="5" Header="回放狀態" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock x:Name="PlaybackStatusText" Text="等待開始回放..." FontWeight="Bold"/>
                <TextBlock x:Name="TimeRangeText" Text="" Margin="0,5,0,0"/>
                <TextBlock x:Name="SpeedText" Text="" Margin="0,5,0,0"/>
                <TextBlock x:Name="RecordFilesText" Text="" Margin="0,5,0,0" Foreground="DarkGreen"/>
            </StackPanel>
        </GroupBox>

        <!-- 訊息顯示區域 -->
        <GroupBox Grid.Row="6" Header="操作記錄">
            <ScrollViewer x:Name="StatusScrollViewer" VerticalScrollBarVisibility="Auto">
                <TextBlock x:Name="StatusTextBlock" TextWrapping="Wrap" FontFamily="Consolas" 
                          Background="Black" Foreground="LightGreen" Padding="5"/>
            </ScrollViewer>
        </GroupBox>

        <!-- 底部按鈕 -->
        <StackPanel Grid.Row="7" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="關閉" Click="Close_Click" Padding="15,5" IsCancel="True"/>
        </StackPanel>
    </Grid>
</Window>